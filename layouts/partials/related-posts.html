{{- $related := .Site.RegularPages.Related . | first 5 -}}
{{- $relatedPosts := .Params.related_posts -}}
{{- $prerequisites := .Params.prerequisites -}}
{{- $nextSteps := .Params.next_steps -}}

{{- if or $related $relatedPosts $prerequisites $nextSteps -}}
<div class="related-content">
    {{- if $prerequisites -}}
    <div class="prerequisites-section">
        <h3>ðŸ“š Prerequisites</h3>
        <p>Before diving into this topic, you might want to read:</p>
        <ul class="related-list">
        {{- range $prerequisites -}}
            <li><a href="{{ .url }}">{{ .title }}</a> - {{ .description }}</li>
        {{- end -}}
        </ul>
    </div>
    {{- end -}}

    {{- if $nextSteps -}}
    <div class="next-steps-section">
        <h3>ðŸš€ Next Steps</h3>
        <p>Ready to go deeper? Continue with:</p>
        <ul class="related-list">
        {{- range $nextSteps -}}
            <li><a href="{{ .url }}">{{ .title }}</a> - {{ .description }}</li>
        {{- end -}}
        </ul>
    </div>
    {{- end -}}

    {{- if $relatedPosts -}}
    <div class="related-posts-section">
        <h3>ðŸ”— Related Posts</h3>
        <ul class="related-list">
        {{- range $relatedPosts -}}
            <li><a href="{{ .url }}">{{ .title }}</a> - {{ .description }}</li>
        {{- end -}}
        </ul>
    </div>
    {{- end -}}

    {{- if $related -}}
    <div class="auto-related-section">
        <h3>ðŸ’¡ You Might Also Like</h3>
        <ul class="related-list">
        {{- range $related -}}
            <li><a href="{{ .RelPermalink }}">{{ .Title }}</a> - {{ .Description }}</li>
        {{- end -}}
        </ul>
    </div>
    {{- end -}}
</div>

<style>
.related-content {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 2px solid var(--accent-color, #FF4D4D);
}

.related-content h3 {
    color: var(--accent-color, #FF4D4D);
    margin-bottom: 1rem;
    font-size: 1.2rem;
}

.related-content > div {
    margin-bottom: 2rem;
}

.related-list {
    list-style: none;
    padding: 0;
}

.related-list li {
    margin-bottom: 0.8rem;
    padding: 0.5rem;
    background: rgba(255, 77, 77, 0.05);
    border-radius: 4px;
    border-left: 3px solid var(--accent-color, #FF4D4D);
}

.related-list a {
    font-weight: bold;
    text-decoration: none;
    color: var(--text-color);
}

.related-list a:hover {
    color: var(--accent-color, #FF4D4D);
}

.prerequisites-section {
    background: rgba(0, 100, 255, 0.05);
    padding: 1rem;
    border-radius: 8px;
    border-left: 4px solid #0064ff;
}

.next-steps-section {
    background: rgba(34, 197, 94, 0.05);
    padding: 1rem;
    border-radius: 8px;
    border-left: 4px solid #22c55e;
}

.prerequisites-section .related-list li {
    background: rgba(0, 100, 255, 0.08);
    border-left-color: #0064ff;
}

.next-steps-section .related-list li {
    background: rgba(34, 197, 94, 0.08);
    border-left-color: #22c55e;
}
</style>
{{- end -}}